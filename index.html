// Powered by Leaflet.js under the BSD 2-Clause License

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Velosofize Map</title>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Маршрути и информация за велосипедисти в България.">

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-omnivore/leaflet-omnivore.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    
    <link href="https://unpkg.com/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet" />
    <script src="https://unpkg.com/maplibre-gl/dist/maplibre-gl.js"></script>
    <script src="https://unpkg.com/@maplibre/maplibre-gl-leaflet/leaflet-maplibre-gl.js"></script>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="/src/pageStyle.css" />
  </head>
  <body>
    
    <div id="map"></div>
    
    <input type="file" id="upload-layer">

    <div id="legend-overlay">
      <div>
        <button id="close-legend-button" title="Затвори / Close">
          <span class="material-symbols-outlined" style="font-size: 16px;">close</span>
        </button>
        <button id="switch-language-legend-button" title="Език / Language">
          <span class="material-symbols-outlined" style="font-size: 16px;">letter_switch</span>
        </button>
        <iframe id="legend-iframe" 
        src="/legend/bg/cyclosm_legend.html">
        </iframe>
      </div>
    </div>

    <div id="project-header">
      <img
        src="/attachments/favicon_light/favicon-32x32.png"
        alt="Velosofize Icon">
      <span id="velosofize-title" style="line-height: 1;">VELOSOFIZE</span>
      <span id="velosofize-arrow" class="material-symbols-outlined">arrow_drop_down</span>
      <div id="link-buttons">
        <a href="https://www.google.com/maps/d/u/0/edit?mid=13Ke06MOSLTuBBbr2ITKNV7kLhs_v2Qc&usp=sharing"
          target="_blank" title="Google Maps">
          <img
            src="https://www.gstatic.com/marketing-cms/assets/images/48/6b/6a951c294a47991a8229779b508e/maps.webp=s108-fcrop64=1,00000000ffffffff-rw"
            alt="Google Maps">
        </a>
        <a href="https://earth.google.com/web/@42.68536362,23.34252187,551.21893103a,13559.28278408d,35y,-0h,0t,0r/data=CgRCAggBMigKJgokCiAxM0tlMDZNT1NMVHVCQmJyMklUS05WN2tMaHNfdjJRYyACOgMKATBCAggASggI3rfSkgMQAQ"
          target="_blank" title="Google Earth">
          <img
            src="https://www.gstatic.com/marketing-cms/assets/images/32/80/489eca5d4dfab22aa3901c6c882a/g-earth.webp=s108-fcrop64=1,00000000ffffffff-rw"
            alt="Google Earth">
        </a>
        <a href="https://github.com/velosofist/velosofize-map/tree/main/export_formats"
          target="_blank" title="GitHub export options">
          <img
            src="/attachments/github-mark/github-mark.png"
            alt="GitHub">
        </a>
        <a href="https://docs.velosofize.com"
          target="_blank" title="Written materials">
          <img
            src="/attachments/misc_icons/docs_icon_dark.png"
            alt="Written materials">
        </a>
      </div>
    </div>


    <div id ='container-overlays-buttons'
    class="button-container">
      <div id="overlay-toggle-secondary" class="button-container-pod"></div>
    </div>

    <div id="container-misc-buttons"
    class="button-container">
      <div class="button-container-pod"></div>
    </div>

    <div id ='container-overlays-external-buttons'
    class="button-container">
      <div id="overlay-toggle-external" class="button-container-pod"></div>
    </div>

    <div id="overlay-zoom"></div>
  
    <div id="layer-switcher-container">
      <button id="layer-icon-btn">
        <img id="layer-icon-img" src="tile_icons/tile_cyclosm.png" 
        alt="CyclOSM"
        >
      </button>
    </div>
    
    <div id="layer-name-flash">
  </div>

  <script>
    function loadConfigScript(src, onload, onerror) {
      const script = document.createElement('script');
      script.src = src;
      if (onload) script.onload = onload;
      if (onerror) script.onerror = onerror;
      document.head.appendChild(script);
    }

    function loadAppScripts() {
      [
        'src/baseLayer.js',
        'src/navigation.js',
        'src/main.js',
        'src/overlays.js',
        'src/ios.js',
        'src/controlButtons.js',
        'src/miscButtons.js',
        'src/legend.js'
      ].forEach(function(src) {
        const s = document.createElement('script');
        s.src = src;
        document.head.appendChild(s);
      });
    }

    loadConfigScript('/imports/src/configOverride.js', loadAppScripts, function() {
      loadConfigScript('/src/configHardcoded.js', loadAppScripts);
    });
  </script>
  </body>
</html>